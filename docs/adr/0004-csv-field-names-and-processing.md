# 0004 - CSV Field Names and Processing

Date: April 25, 2023

## Status

Accepted

## Context

In updating the "PATSy" and "preserve" toolkits to handle hard drive-based
storage locations it was noticed that:

1) There has been a drift in terminology in referring to an item's file-based
   location from "storage path" to "storage location"

2) The field names in the header line are not standardized with regards to case,
   with some fields being UPPER-CASE and some fields being lower-case

3) CSV processing has typically been "permissive" in allowing extra fields,
   which are simply ignored when processed.

This combination of factors can result in unexpected behavior when processing
CSV files, as an optional field with a lower-case name may be ignored without
warning because the processing application is expecting the field to have an
upper-case name.

## Decision

CSV files should conform to the following:

* In the CSV header line, all field names should be UPPER-CASE
* In the CSV header line, field names should be UPPER-CASE, with no delimiters
  between words (i.e. "MODDATE" instead of "MOD_DATE", "STORAGELOCATION" instead
  of "storage_location").
* When processing, optional CSV fields are allowed, but "extra" fields are not.
  CSV input with extra fields should be considered invalid, and the user
  notified.
* References in CSV files to the "storage path" field (in whatever case,
  spacing, or delimiter) should be changed to "STORAGELOCATION"

## Consequences

The primary consequence is to ensure greater consistency in the CSV input and
output formats used and generated by the toolkits. This should simplify the
input handling routines, by enabling more reliable methods for determining what
is valid input.

One negative consequence is the inability to process CSV files that the toolkits
were previously able to process. From discussions with stakeholders this was not
expected to be a serious issue, because:

* Legacy CSV files are rarely re-processed
* Several generations of legacy CSV files already exist that the toolkits likely
  cannot process
* Writing a script to convert a legacy CSV file to an acceptable format is
  usually straight-forward
* It is better for the toolkits to fail fast and loudly when given unexpected
  input, than to attempt to process it, and fail in a silent manner
